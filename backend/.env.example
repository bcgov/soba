# trace, debug, info, warn, error, fatal - http / morgan is info level by default
LOG_LEVEL=info

# FormIO (credentials in .env.local)
# Local Form.io from .devcontainer/docker-compose.yml (formio@localhost.com / formio)
FORMIO_BASE_URL=http://host.docker.internal:3001
FORMIO_ADMIN_USERNAME=
FORMIO_ADMIN_PASSWORD=
FORMIO_MANAGER_USERNAME=
FORMIO_MANAGER_PASSWORD=

# Form engine plugin (versioned)
FORM_ENGINE_DEFAULT_CODE=formio-v5

# Cache plugin (e.g. cache-memory, cache-redis). Defaults to cache-memory if unset. Plugin-specific: PLUGIN_CACHE_<CODE>_*
CACHE_DEFAULT_CODE=cache-memory

# MessageBus plugin (e.g. messagebus-memory, messagebus-redis). Defaults to messagebus-memory if unset. Plugin-specific: PLUGIN_MESSAGEBUS_<CODE>_*
MESSAGEBUS_DEFAULT_CODE=messagebus-memory

# Form.io v5 plugin config (PLUGIN_FORMIO_V5_* â€” no legacy FORMIO_* fallback)
PLUGIN_FORMIO_V5_API_BASE_URL=http://host.docker.internal:3001
PLUGIN_FORMIO_V5_ADMIN_API_URL=http://host.docker.internal:3001
PLUGIN_FORMIO_V5_RENDER_API_URL=http://host.docker.internal:3001
PLUGIN_FORMIO_V5_ADMIN_USERNAME=
PLUGIN_FORMIO_V5_ADMIN_PASSWORD=
PLUGIN_FORMIO_V5_MANAGER_USERNAME=
PLUGIN_FORMIO_V5_MANAGER_PASSWORD=
# PLUGIN_FORMIO_V5_PROJECT_PATH=
# PLUGIN_FORMIO_V5_VERSION=v5

# Future: formio-v4 side-by-side (same keys, different prefix)
# PLUGIN_FORMIO_V4_API_BASE_URL=
# PLUGIN_FORMIO_V4_ADMIN_API_URL=
# PLUGIN_FORMIO_V4_RENDER_API_URL=
# PLUGIN_FORMIO_V4_ADMIN_USERNAME=
# PLUGIN_FORMIO_V4_ADMIN_PASSWORD=
# PLUGIN_FORMIO_V4_MANAGER_USERNAME=
# PLUGIN_FORMIO_V4_MANAGER_PASSWORD=
# PLUGIN_FORMIO_V4_PROJECT_PATH=
# PLUGIN_FORMIO_V4_VERSION=v4

# IdP plugin (same pattern as CACHE_DEFAULT_CODE, FORM_ENGINE_DEFAULT_CODE)
IDP_PLUGIN_DEFAULT_CODE=bcgov-sso

# Default SSO JWT config (BC Gov Keycloak); used by bcgov-sso when PLUGIN_BCGOV_SSO_* not set
IDP_PLUGIN_DEFAULT_SSO_JWKS_URI=https://dev.loginproxy.gov.bc.ca/auth/realms/standard/protocol/openid-connect/certs
IDP_PLUGIN_DEFAULT_SSO_JWT_ISSUER=https://dev.loginproxy.gov.bc.ca/auth/realms/standard
IDP_PLUGIN_DEFAULT_SSO_JWT_AUDIENCE=connected-services-submit-6349

# Optional: multiple IdP plugins (comma-separated, try in order). When unset, uses IDP_PLUGIN_DEFAULT_CODE only
# IDP_PLUGINS=bcgov-sso
# Optional overrides for bcgov-sso: PLUGIN_BCGOV_SSO_JWKS_URI, PLUGIN_BCGOV_SSO_JWT_ISSUER, PLUGIN_BCGOV_SSO_JWT_AUDIENCE
# Optional: idp-github (e.g. GitHub Enterprise). Defaults to https://api.github.com
# PLUGIN_IDP_GITHUB_GITHUB_API_URL=https://api.github.com

# Session (set in .env.local)
# SESSION_SECRET=

# Role mapping
ROLE_FIELD=client_roles
ADMIN_ROLE_NAME=TMS.OPERATIONS_ADMIN
MANAGER_ROLE_NAME=TMS.OPERATIONS_MANAGER

# Optional: example JWT for testing
#EXAMPLE_JWT=

# Sign-in test script (scripts/test-signin.ts): token for the IdP you are testing
# SOBA_TEST_TOKEN=ghp_xxx   # or $(gh auth token) for GitHub
# SOBA_TEST_TOKEN=eyJ...    # BC Gov SSO JWT
# SOBA_API_BASE_URL=http://localhost:4000  # optional; default localhost:4000

# Application
NODE_ENV=development

# Database (workspace-first SOBA core)
DATABASE_URL=postgres://postgres:postgres@localhost:5432/soba
DB_ADMIN_DATABASE=postgres
DB_POOL_MAX=10

# Outbox worker
OUTBOX_POLL_INTERVAL_MS=5000
OUTBOX_BATCH_SIZE=25
# System user identity: subject for provider=system (seed creates this user). Used to resolve system actor for outbox worker. Default: soba-system
SOBA_SYSTEM_SUBJECT=soba-system

# Workspace plugin resolver hints
# Enterprise plugin may use these headers from gateway:
# x-enterprise-workspace-id, x-cstar-tenant-id

# Workspace plugins (feature-sliced plugin activation/config)
WORKSPACE_PLUGINS_ENABLED=enterprise-cstar,personal-local
WORKSPACE_PLUGINS_STRICT_MODE=false

# Enterprise CSTAR plugin config
PLUGIN_ENTERPRISE_CSTAR_HEADER_KEYS=x-enterprise-workspace-id,x-cstar-tenant-id
PLUGIN_ENTERPRISE_CSTAR_REQUIRE_EXTERNAL_HEADER=false

# Personal local plugin config
PLUGIN_PERSONAL_LOCAL_COOKIE_KEY=soba_workspace_id
PLUGIN_PERSONAL_LOCAL_ALLOW_HEADER_OVERRIDE=true